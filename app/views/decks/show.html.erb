<head>
    <style>
  #container {
    border-radius: 5px;
    background-color: white;
    border: 1px solid #000;
    overflow: hidden;
    }

  #container > div {
    height: 200px;
    background-color: red;
}
  </style>
</head>

<body>
  <div class = "row">
    <%= render partial: 'shared/title'%>
  </div>

  <div class = "row">
    <div class = "col-lg-1">
      <%= link_to image_tag('fbshare.jpg'),'http://www.facebook.com/sharer.php?u='+request.original_url, :target => :blank %>
      <%= link_to image_tag('redditshare.png'), 'http://www.reddit.com/submit?url='+request.original_url, :target => :blank %>
    </div>

    <% if !@cards.empty? && !@count.nil? %>     
      <% @array = @cards.to_a %>
      <% card = @array.at(@count) %>
    <%end%>

    <div class = "col-lg-4">
      <table class = "questionCard<%= @deck.background%>">
        <tr>
          <td>
            <div class = "box">
              <div class = "boxtext">
                <%=card.qtext.html_safe%>
              </div>
            </div>
          </td>
        </tr>
      </table>
      
      <table>
          <tr>
            <td style = "text-align:right; width:127px">
              <%= render 'shared/prev' %>
              <div id="prevb" class="hover">
              <button type="button" class="btn btn-small btn-info"
              onclick="goTo(mycount-1)" id="prev_link">
                <%=image_tag('left.png', :title=>"Previous")%>
              </button>
              <div class = "tooltip" style = "width:6.1em; top:25px; align:right;">
              Previous
            </div>
              </div>         
            </td>
            <td style = "text-align:center">
              <div id="ranb" class="hover">
                <button type="button" class="btn btn-small btn-info"
              onclick="shuffleArrays(questions,answers)" id="rand_link">
                  <%=image_tag('shuffle.png', :title=>"Shuffle")%>
                </button>
                <div class = "tooltip" style = "width:6.1em; top:25px">
              Shuffle
            </div>
              </div>
            </td>
            <td style = "text-align:left">
              <div id="nextb" class="hover">
                <button type="button" class="btn btn-small btn-info"
              onclick="goTo(mycount+1)" id="next_link">
                  <%=image_tag('next.png', :title=>"Next Card")%>
                </button>
                <div class = "tooltip" style = "width:6.1em; top:25px">
              Next
            </div>
            </div>
            </td>
            <td>
            <div id="showAButton" class = "hover" >
              <button type="button" onclick="showAns()", class= "btn btn-small btn-info">
                <%=image_tag('view.png', :title=>"Show Answer")%>
              </button>
              <%= render 'shared/show' %>
              <div class = "tooltip" style = "width:6.1em; top:25px">
              Show Answer
            </div>
            </div>
            <div id="hideAButton", style = "display: none" class = "hover" >
              <button type="button" onclick="hideAns()", class= "btn btn-small btn-danger">
                <%=image_tag('hide.png', :title=>"Hide Answer")%>
              </button>
              <div class = "tooltip" style = "width:6em; top:25px">
              Hide Answer
            </div>
            </div>
            </td>
          </tr>
      </table>
    </div>

    <div class = "col-lg-4">
      <table class = "questionCard<%= @deck.background%>">
        <tr>
          <td>
            <div class = "box">
              <div class = "boxtext">
                <%=card.atext.html_safe%>
              </div>
            </div>
          </td>
        </tr>
      </table>
     
      <% if user_signed_in? %>
        <div style = "padding:1px;">

          <% if Deckrating.find_by(deck_id: @deck.deck_id, user_id: @userID).nil? %>
            <p> 
              <%= link_to image_tag('like.png', :title=>"Like"), {:controller => "decks", :action => 'rate', :userID => @userID,:liked => true, :deckID => @deck.deck_id, :count => @count}, class: "btn btn-small btn-info"%> 
              <%= link_to image_tag('dislike.png', :title=>"Dislike"), {:controller => "decks", :action => 'rate', :userID => @userID,:liked => false, :deckID => @deck.deck_id, :count => @count}, class: "btn btn-small btn-danger" %>
            </p>
          <% else %>
            <% if Deckrating.find_by(deck_id: @deck.deck_id, user_id: @userID).liked == true %>
              <%= link_to image_tag('like.png', :title=>"Remove Rating"), {:controller => "decks", :action => 'unrate', :userID => @userID, :deckID => @deck.deck_id, :count => @count}, class: "btn btn-small btn-warning" %>
              <%= link_to image_tag('dislike.png', :title=>"Dislike"), {:controller => "decks", :action => 'rate',:userID => @userID,:liked => false, :deckID => @deck.deck_id, :count => @count}, class: "btn btn-small btn-danger" %> 
            <% else %>
              <%= link_to image_tag('like.png', :title=>"Like"), {:controller => "decks", :action => 'rate', :userID => @userID,:liked => true, :deckID => @deck.deck_id, :count => @count}, class: "btn btn-small btn-info" %>  
              <%= link_to image_tag('dislike.png', :title=>"Remove Rating"), {:controller => "decks", :action => 'unrate', :userID => @userID, :deckID => @deck.deck_id, :count => @count}, class: "btn btn-small btn-warning" %>
            <% end %>
          <% end %>

          <% if Deckrating.where(deck_id: @deck.deck_id).empty? %>
          <% else %>
            <% @liked = Deckrating.where(deck_id: @deck.deck_id, liked: true).count %>
            <% @total = Deckrating.where(deck_id: @deck.deck_id).count %>
            <% @percent = (@liked * 100 / @total) %>
            <% if @percent > 49 %>
              <div class = 'likedText', style = "color:#0D55D1;text-align:right;"><%= @percent %>% liked </div>
            <% else %>
              <div class = 'likedText', style = "color:red;text-align:right;"><%= @percent %>% liked </div>
            <% end %>
          <% end %>
        </div>
      <% end %>




    </div>
  </div>

  <div style = "padding-top:20px;">
  <table>
    <tr>
       <td>
        <% if user_signed_in? %>
          <% if SavedDeck.find_by(:user_id => @userID, :deck_id => @deck.deck_id).nil? %>
          <div class= "hover">
            <%= link_to image_tag('save.png'), {:controller => "decks", :action => 'addfavorite',:userID => @userID,:favid => @deck.deck_id, :count => @count}, class: "btn btn-small btn-success"%>
            <div class = "tooltip">
              Save this Deck
            </div>
          </div>
          <% else %>
          <div class= "hover">
            <%= link_to image_tag('unsave.png'), {:controller => "decks", :action => 'removefavorite', :userID => @userID,:favid => @deck.deck_id, :count => @count}, class: "btn btn-small btn-warning" %>
            <div class = "tooltip">
              Forget this Deck
            </div>
          </div>
          <% end %>
        <% else %>
        <% end %>
      </td>
       <td>
      <% if card.nil?
        @cardID = 0
      else @cardID = card.card_id
      end
      %>

      <% if user_signed_in? %>
      <div class= "hover">
       <%= link_to image_tag('flag.png'), {:controller => "decks", :action => 'flag', :count => @count, :deckID => @deck.deck_id, :userID => @userID, :cardID => @cardID}, class: "btn btn-small btn-warning"%>
       <div class = "tooltip" style = "width:10em; top:25px">
              Flag as Inappropriate
            </div>
          </div>
      <% else %>
      <div class= "hover">
       <%= link_to image_tag('flag.png', :title=>"Flag this deck/card for inappropriate content"), {:controller => "decks", :action => 'flag', :count => @count, :deckID => @deck.deck_id, :userID => 0, :cardID => @cardID}, class: "btn btn-small btn-warning"%>
       <div class = "tooltip" style = "width:10em; top:25px">
              Flag as Inappropriate
            </div>
          </div>
      <% end %>
      </td>
      <% if !card.nil? && Deck.find_by(deck_id: card.deck_id).user_id == @userID %>
        <td>
          <div class= "hover">
            <%= link_to image_tag('edit.png'), {:controller => "cards", :action => 'edit', :count => @count, :id => card.card_id}, class: "btn btn-small btn-info"%>
            <div class = "tooltip" style = "width:6.5em;">
              Edit this Card
            </div>
          </div>
        </td>
        <td>
          <div class= "hover">
            <%= link_to image_tag('delete.png'), card, method: :delete, data: { confirm: "Are you sure you want to delete this deck?" }, class: "btn btn-small btn-danger" %>
            <div class = "tooltip">
              Delete this Card
            </div>
          </div>
        </td>
      <% end %>
      <td>
        <div class = "howto">
          Right Arrow - Next &nbsp&nbsp
          Left Arrow  - Previous &nbsp&nbsp
          A - Show/hide answer &nbsp&nbsp
          S - Shuffle
        </div>
      </td>
    </tr>
  </table>
  </div>
</body>