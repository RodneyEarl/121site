<head>
 <script type="text/javascript">
        function showAns(){
          $("#showAnswer").show();
          $("#showAButton").hide();
        }
        function hideAns(){
            $("#showAnswer").hide();
            $("#showAButton").show();
        }
        </script>
</head>
<body>



<h1> <%= @deck.deckTitle %> </h1>
 <% if !@deck.courseName.nil? %>
       
        <h2><%= @deck.subjectName %> - <%= @deck.courseNum %> - <%= @deck.courseName %> </h2>
        
    <% else %> 
        
        <h2><%= @deck.subjectName %> - <%= @deck.courseNum %> </h2>
        
    <% end %>


    <% if Deckrating.where(deck_id: @deck.deck_id).empty? %>
        <p> No ratings </p>
    <% else %>

        <% @liked = Deckrating.where(deck_id: @deck.deck_id, liked: true).count %>
        <% @total = Deckrating.where(deck_id: @deck.deck_id).count %>
        <% @percent = (@liked * 100 / @total) %>
        <p><%= @percent %>% liked </p>
    <% end %>


    <% if SavedDeck.find_by(:user_id => @userID, :deck_id => @deck.deck_id).nil? %>

    <%= link_to "Save this Deck", {:controller => "decks", :action => 'addfavorite', 
    :userID => @userID,:favid => @deck.deck_id} %>
     <br/>
     <% else %>
     
    <%= link_to "Un-Save this Deck", {:controller => "decks", :action => 'removefavorite', 
    :userID => @userID,:favid => @deck.deck_id} %>
    <br/>
     <% end %>
    
     <%  if Deckrating.find_by(deck_id: @deck.deck_id, user_id: @userID).nil? %>
         <p> <%= link_to "Like", {:controller => "decks", :action => 'rate', 
        :userID => @userID,:liked => true, :deckID => @deck.deck_id, :count => @count} %> / 
        <%= link_to "Dislike", {:controller => "decks", :action => 'rate', 
        :userID => @userID,:liked => false, :deckID => @deck.deck_id, :count => @count} %> </p>

    <% else %>
        <%  if Deckrating.find_by(deck_id: @deck.deck_id, user_id: @userID).liked == true %>
        <p> Deck liked. <%= link_to "Dislike", {:controller => "decks", :action => 'rate', 
         :userID => @userID,:liked => false, :deckID => @deck.deck_id, :count => @count} %> 
          </p> 
        <% else %>
        <p> Deck disliked. <%= link_to "Like", {:controller => "decks", :action => 'rate', 
        :userID => @userID,:liked => true, :deckID => @deck.deck_id, :count => @count} %>  </p> 
        <% end %>
        <%= link_to "Unrate", {:controller => "decks", :action => 'unrate', 
         :userID => @userID, :deckID => @deck.deck_id, :count => @count} %>
    <% end %>

    <% if !@cards.empty? %>
    <% @array = @cards.to_a %>
  <% 
      card = @array.at(@count)
  %>

  <div class = "row">
       <aside class="span6">
      <section>
      <div>
     
    <h1><b>Question:</b> </h1><br/><h4> <%= card.qtext 
    %></h4>
        <br/>
        <div id="showAButton" ><button type="button" onclick="showAns()", class= "btn btn-small btn-primary">Show Answer</button>
               </div>
  
</div>
         </section>
    </aside>
    <aside class="span6">
      <section>
<div id="showAnswer", style= "display: none">
        <p class="ex4"> <h1><b>Answer:</b> </h1><br/><h4><%= card.atext %></h4></p>  
         
        <button type="button" onclick="hideAns()", class= "btn btn-small btn-primary">Hide Answer</button>
              
</div> 
      </section>
    </aside>
    </div>



    <div class="row">
       <aside class="span6">
      <section>

      <% if @count>0 %>
     <%= link_to "Previous Card", deck_path(card.deck_id, :count => @count-1), 
     class: "btn btn-medium btn-primary" %>
     <% end %>

      <% if @count<(@array.size - 1) %>
     <%= link_to "Next Card", deck_path(card.deck_id, :count => @count+1), 
      class: "btn btn-medium btn-primary" %>
     <% end %>
     <br/><br/>
 
     <%= link_to "Random Card!", deck_path(card.deck_id, :count => rand(@array.size)), 
     class: "btn btn-medium btn-primary" %>

   </section>
    </aside>
     </div>


    <% if !card.nil? %>
    <% if Deck.find_by(deck_id: card.deck_id).user_id == @userID %>


    <%= link_to "Edit this Card", edit_card_path(card.card_id)%>
     <br/>
     <%= link_to "Delete this Card", card, method: :delete, data: { confirm: "You sure?" } %>
    <br/> 


    <% end %>
    <% end %> 

  <% end %>  


</body>



